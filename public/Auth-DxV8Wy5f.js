import{r as d,A as g,j as e,a as j}from"./index-CkTn6Lmz.js";import{C as w}from"./Card-YHaYoNZJ.js";import{u as T,I as n,V as L,b as S,a as V}from"./form-hook-aLdVfINw.js";import{u as y,E as A,B as m}from"./http-hook-wdNFrn97.js";import{I as E}from"./ImageUpload-BvQX2PhG.js";const b=()=>{const o=d.useContext(g),[t,c]=d.useState(!0),{isLoading:x,error:I,sendRequest:l,clearError:h}=y(),[a,i,p]=T({email:{value:"",isValid:!1},password:{value:"",isValid:!1}},!1),v=()=>{t?p({...a.inputs,name:{value:"",isValid:!1},image:{value:null,isValid:!1}},!1):p({...a.inputs,name:void 0,image:void 0},a.inputs.email.isValid&&a.inputs.password.isValid),c(r=>!r)},f=async r=>{if(r.preventDefault(),console.log(a.inputs),t)try{const s=await l("http://localhost:5000/api/users/login","POST",JSON.stringify({email:a.inputs.email.value,password:a.inputs.password.value}),{"Content-Type":"application/json"});o.login(s.userId,s.token)}catch{}else try{const s=new FormData;s.append("name",a.inputs.name.value),s.append("email",a.inputs.email.value),s.append("password",a.inputs.password.value),s.append("image",a.inputs.image.value);const u=await l("http://localhost:5000/api/users/signup","POST",s);o.login(u.userIs,u.token)}catch{}};return e.jsxs(e.Fragment,{children:[e.jsx(A,{error:I,onClear:h}),e.jsxs(w,{className:"authentication",children:[x&&e.jsx(j,{asOverlay:!0}),e.jsx("h2",{children:"Login Required"}),e.jsx("hr",{}),e.jsxs("form",{onSubmit:f,children:[!t&&e.jsx(n,{element:"input",id:"name",type:"text",label:"Your Name",validators:[L()],errorText:"Please enter a name.",onInput:i}),!t&&e.jsx(E,{center:"center",id:"image",onInput:i,errorText:"Please provide an image"}),e.jsx(n,{element:"input",id:"email",type:"email",label:"E-Mail",validators:[S()],errorText:"Please enter a valid email address.",onInput:i}),e.jsx(n,{element:"input",id:"password",type:"password",label:"Password",validators:[V(6)],errorText:"Please enter a valid password, at least 6 characters.",onInput:i}),e.jsx(m,{type:"submit",disabled:!a.isValid,children:t?"LOGIN":"SIGNUP"})]}),e.jsxs(m,{inverse:!0,onClick:v,children:["SWITCH TO ",t?"SIGNUP":"LOGIN"]})]})]})};export{b as default};
