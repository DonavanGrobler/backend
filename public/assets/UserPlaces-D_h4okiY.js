import{r as c,j as e,A as M,a as C,b as N}from"./index-CkTn6Lmz.js";import{u as E,E as g,M as f,B as r}from"./http-hook-wdNFrn97.js";import{C as w}from"./Card-YHaYoNZJ.js";const _=s=>{const t=c.useRef(),{center:a,zoom:n}=s;return c.useEffect(()=>{const l=new window.google.maps.Map(t.current,{center:a,zoom:n});new window.google.maps.Marker({position:a,map:l})},[a,n]),e.jsx("div",{ref:t,className:`map ${s.className}`,style:s.style})},P=s=>{const t=c.useContext(M),[a,n]=c.useState(!1),[l,i]=c.useState(!1),{isLoading:d,error:m,sendRequest:h,clearError:o}=E(),u=()=>n(!0),x=()=>n(!1),p=()=>{i(!0)},j=()=>{i(!1)},D=async()=>{i(!1);try{await h(`http://localhost:5000/api/places/${s.id}`,"DELETE",null,{Authorization:"Bearer "+t.token}),s.onDelete(s.id)}catch{}};return e.jsxs(e.Fragment,{children:[e.jsx(g,{error:m,onClear:o}),e.jsx(f,{show:a,onCancel:x,header:s.address,contentClass:"place-item__modal-content",footerClass:"place-item__modal-actions",footer:e.jsx(r,{onClick:x,children:"CLOSE"}),children:e.jsx("div",{className:"map-container",children:e.jsx(_,{center:s.coordinates,zoom:16})})}),e.jsx(f,{show:l,onCancel:j,header:"Are you sure?",footerClass:"place-item__modal-actions",footer:e.jsxs(e.Fragment,{children:[e.jsx(r,{inverse:!0,onClick:j,children:"CANCEL"}),e.jsx(r,{danger:!0,onClick:D,children:"DELETE"})]}),children:e.jsx("p",{children:"Do you want to proceed and delete this place? Please note that it can't be undone thereafter."})}),e.jsx("li",{className:"place-item",children:e.jsxs(w,{className:"place-item__content",children:[d&&e.jsx(C,{}),e.jsx("div",{className:"place-item__image",children:e.jsx("img",{src:`http://localhost:5000/${s.image}`,alt:s.title})}),e.jsxs("div",{className:"place-item__info",children:[e.jsx("h2",{children:s.title}),e.jsx("h3",{children:s.address}),e.jsx("p",{children:s.description})]}),e.jsxs("div",{className:"place-item__actions",children:[e.jsx(r,{inverse:!0,onClick:u,children:"VIEW ON MAP"}),t.userId==s.creatorId&&e.jsx(r,{to:`/places/${s.id}`,children:"EDIT"}),t.userId==s.creatorId&&e.jsx(r,{danger:!0,onClick:p,children:"DELETE"})]})]})})]})},I=s=>s.items.length===0?e.jsx("div",{className:"place-list center",children:e.jsxs(w,{children:[e.jsx("h2",{children:"No places found. Maybe create one?"}),e.jsx(r,{to:"/places/new",children:"Share Place"})]})}):e.jsx("ul",{className:"place-list",children:s.items.map(t=>e.jsx(P,{id:t.id,image:t.image,title:t.title,description:t.description,address:t.address,creatorId:t.creator,coordinates:t.location,onDelete:s.onDeletePlace},t.id))}),k=()=>{const[s,t]=c.useState(),{isLoading:a,error:n,sendRequest:l,clearError:i}=E(),d=N().userId;c.useEffect(()=>{(async()=>{try{const o=await l(`http://localhost:5000/api/places/user/${d}`);t(o.places)}catch{}})()},[l,d]);const m=h=>{t(o=>o.filter(u=>u.id!==h))};return e.jsxs(e.Fragment,{children:[e.jsx(g,{error:n,onClear:i}),a&&e.jsx("div",{className:"center",children:e.jsx(C,{})}),!a&&s&&e.jsx(I,{items:s,onDeletePlace:m})]})};export{k as default};
